---
layout: post
title: "Google spreadsheetsを使ってデータの分析をする"
date: 2016-05-18 13:46:32 +0900
comments: true
categories: 
description: "データの分析によく使われるエクセルですが、Google Spreadsheetsでも様々な関数が用意されています。関数を使えば日付の差分を調べたり、特定の条件に一致するデータをカウントすることができます。"
---

データの分析によく使われるエクセルですが、Google Spreadsheetsでも様々な関数が用意されています。  
関数を使えば日付の差分を調べたり、特定の条件に一致するデータをカウントすることができます。  
Google Spreadsheetsを使ってデータの集計、分析をするためのTipsの紹介をします。

## 日付の差分を調べる

例えばユーザーの契約日数を調べたいとしましょう。  
`DATEVALUE`を使って以下のように計算できます。

```
=DATEVALUE("2016/05/17") - DATEVALUE("2016/05/01")
```

セルを指定することもできます。

```
=DATEVALUE(A2) - DATEVALUE(A1)
```

月で表示したい場合は30で割ります。
FLOORは小数点を切り捨てるために使っています。

```
=FLOOR((DATEVALUE("2016/05/17") - DATEVALUE("2015/05/01"))/30, 0.1)
```

## 特定の条件をカウントする

例えば、契約期間が1年未満のユーザーをカウントする場合は`COUNTIFS`を使います。

```
=COUNTIFS(A1:A1000, ">365")
```

`COUNTIFS`は複数条件を指定できます。  
契約期間が1年以上〜2年未満のユーザーをカウントするということができます。

```
=COUNTIFS(A1:A1000, ">=365", I3:I1009, "<730")
```

## 点数を分析する

平均点を求めることは `AVERAGE` を使えばできます。  
平均だけでなくばらつきを求めると違った角度でデータを捉えることができます。  
ばらつきは標準偏差を求める関数 `STDEVP`で求めることができます。

```
= STDEVP(A1:E1)
```

例えばそれぞれの項目にたいして点数をつけるアンケートがあるとします。  
以下の2つの項目は平均点は同じですが、標準偏差を求めるとばらつきがあることがわかります。  
標準偏差を使えばこのようなデータを見つけることができます。

点数 | | | | | 平均点  | 標準偏差
------------ | ------------- | ------------- | ------------- | ------------- | ------------- | -------------
6 |  7  |  9  |  7  |  6  |  7  |  1.095445115
8 |   5  |  10  |  7  |  5  |  7  | 1.897366596

サンプルを用意しました。参考にどうぞ。  
https://docs.google.com/spreadsheets/d/1bOc3s8ikFcbBPGuzxDbRzd8KVT00lgQUDz275TJAIoE/edit#gid=0
